import{N as i,r as l,R as f}from"./DILZzNnB.js";const h=i("auth",()=>{const t=l(null),a=l(!1),n=f();async function s(){const e=localStorage.getItem("token");if(!e)return t.value=null,!1;try{a.value=!0;const r=await $fetch("/auth/info",{baseURL:n.public.apiUrl,headers:{Authorization:`Bearer ${e}`}});return t.value=r.user,!0}catch{return t.value=null,!1}finally{a.value=!1}}async function u(e,r){try{a.value=!0;const o=await $fetch("/auth/login",{baseURL:n.public.apiUrl,body:{username:e,password:r},method:"post"});return localStorage.setItem("token",o.token),{error:!1,message:o.message}}catch(o){return{message:o.response._data.message,error:!0}}finally{a.value=!1}}async function c(){try{const e=localStorage.getItem("token");await $fetch("/auth/logout",{baseURL:n.public.apiUrl,headers:{Authorization:`Bearer ${e}`},method:"post"})}catch{}finally{localStorage.removeItem("token"),t.value=null}}return{user:t,sync:s,login:u,logout:c,loading:a}});export{h as u};
