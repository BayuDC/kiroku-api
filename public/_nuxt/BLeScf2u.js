import{a as D,_ as S}from"./BlcR6lzQ.js";import{_ as U}from"./CwxRBsd3.js";import{e as $,r as w,s as I,g as N,o as a,w as k,a as s,c as r,l as d,b as f,k as n,F as _,x as z,i as V,t as c,v as C,j as F,d as q}from"./DILZzNnB.js";import{u as L}from"./Dk7syTNn.js";import{u as A}from"./BLw3PmVo.js";import{w as P}from"./DKo_HIg7.js";const j={class:"w-full"},E={class:"w-full"},H={class:"relative w-full mb-3"},K={key:0,class:"mb-2"},M={class:"flex flex-col gap-3 mb-4"},R={class:"border-0 px-2 py-1 placeholder-blueGray-300 text-blueGray-600 relative bg-white rounded text-sm shadow outline-none focus:outline-none focus:shadow-outline w-full"},J=["onUpdate:modelValue","max","disabled"],O=["onClick"],Q={key:0,class:"block text-blueGray-600 text-xs font-medium mb-2 mt-1 text-red-500",htmlfor:"grid-password"},W={key:1,class:"mt-2"},X={class:"flex items-center py-1 gap-2"},Y=["onClick"],Z={class:"text-sm font-bold text-gray-500"},ee={class:"text-sm px-2 py-1 rounded bg-blue-100 text-blue-600"},te={key:1},oe={class:"w-full"},ae={class:"w-full"},se={key:1,class:"mt-4 flex gap-2"},me=$({__name:"FormUsage",props:{freeze:{type:Boolean}},emits:["save"],async setup(ne){let m,g;const l=L(),u=w(""),b=w(""),{data:x}=([m,g]=I(()=>A("/consumables",{key:"consumables",default:()=>[],query:{search:b,limit:3}})),m=await m,g(),m);P(u,async()=>{if(u.value.length<3){b.value="";return}b.value=u.value},{throttle:1e3});function G(t,o,i,h){const p=l.data.consumables.find(e=>e.id===t);p?p.quantity+=i:l.data.consumables.push({id:t,name:o,quantity:i,stock:h})}function T(t){l.data.consumables.splice(t,1)}function B(t){return new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}return(t,o)=>{const i=D,h=U,p=S;return a(),N(p,{path:"/usages",onSave:o[2]||(o[2]=e=>t.$emit("save")),freeze:t.freeze},{default:k(()=>[s("div",j,[f(i,{modelValue:n(l).data.used_by,"onUpdate:modelValue":o[0]||(o[0]=e=>n(l).data.used_by=e),label:"Pemakai",error:n(l).error.used_by,disabled:t.freeze},null,8,["modelValue","error","disabled"])]),s("div",E,[s("div",H,[o[3]||(o[3]=s("label",{class:"block uppercase text-blueGray-600 text-xs font-bold mb-2",htmlfor:"grid-password"},"Barang",-1)),n(l).data.consumables.length?(a(),r("div",K,[s("ul",M,[(a(!0),r(_,null,z(n(l).data.consumables,(e,y)=>(a(),r("li",{class:"flex gap-1",key:y},[s("div",R,c(e.name)+" (Stok: "+c(e.stock)+") ",1),V(s("input",{class:"w-20 text-center border-0 px-2 py-1 placeholder-blueGray-300 text-blueGray-600 relative bg-white rounded text-sm shadow outline-none focus:outline-none focus:shadow-outline","onUpdate:modelValue":v=>e.quantity=v,type:"number",min:1,max:e.stock,disabled:t.freeze},null,8,J),[[C,e.quantity,void 0,{number:!0}]]),t.freeze?d("",!0):(a(),r("button",{key:0,class:"bg-red-500 text-white active:bg-red-600 text-xs font-bold uppercase px-2 py-1 rounded outline-none focus:outline-none ease-linear transition-all duration-150",type:"button",onClick:v=>T(y)}," Hapus ",8,O))]))),128))])])):d("",!0),t.freeze?d("",!0):(a(),r(_,{key:1},[V(s("input",{type:"text",placeholder:"Cari barang...",class:"border-0 px-2 py-1 placeholder-blueGray-300 text-blueGray-600 relative bg-white rounded text-sm shadow outline-none focus:outline-none focus:shadow-outline w-full","onUpdate:modelValue":o[1]||(o[1]=e=>F(u)?u.value=e:null)},null,512),[[C,n(u)]]),n(l).error.consumables?(a(),r("label",Q,c(n(l).error.consumables),1)):d("",!0),n(b)?(a(),r("div",W,[n(x).length?(a(!0),r(_,{key:0},z(n(x),e=>(a(),r("div",X,[s("button",{class:"bg-indigo-500 text-white active:bg-indigo-600 text-xs font-bold uppercase px-3 py-1 rounded outline-none focus:outline-none ease-linear transition-all duration-150",type:"button",onClick:y=>G(e.id,e.name,1,e.stock)}," Tambah ",8,Y),s("span",Z,c(e.name),1),s("span",ee," Stok: "+c(e.stock),1)]))),256)):(a(),r("div",te,"Tidak ada barang ditemukan"))])):d("",!0)],64))])]),t.freeze?(a(),r(_,{key:0},[s("div",oe,[f(i,{"model-value":B(n(l).data.date),label:"Tanggal",disabled:t.freeze},null,8,["model-value","disabled"])]),s("div",ae,[f(i,{"model-value":n(l).data.staff,label:"Petugas",disabled:t.freeze},null,8,["model-value","disabled"])])],64)):d("",!0),t.freeze?(a(),r("div",se,[f(h,{to:"/usages",class:"bg-gray-500 text-white active:bg-blueGray-600 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150",type:"button"},{default:k(()=>o[4]||(o[4]=[q(" Kembali ",-1)])),_:1,__:[4]})])):d("",!0)]),_:1},8,["freeze"])}}});export{me as _};
