import{_ as M}from"./dbQSbgpy.js";import{u as T,_ as E,a as G,b as J,c as H}from"./CDaJBlPb.js";import{s as K}from"./BQUaNR2D.js";import{u as O}from"./BLw3PmVo.js";import{s as D}from"./BQfcDCpi.js";import{e as U,r as x,s as W,c,a as o,b as r,l as C,w as l,k as a,z as m,F as j,x as P,t as n,n as X,q as Y,o as i,g as Z,d}from"./DILZzNnB.js";import{w as $}from"./DKo_HIg7.js";import"./C0ApsXXQ.js";import"./CwxRBsd3.js";import"./CujQqBoZ.js";import"./RxiBsf8a.js";import"./rHo55hVL.js";import"./B4WT0tcV.js";import"./CTxI3r5K.js";import"./Dk7syTNn.js";import"./DWor5bqZ.js";const ee={class:"px-4 md:px-10 mx-auto w-full -m-24"},te={class:"flex flex-wrap px-4"},ae={class:"w-full"},oe={key:0,class:"mb-6"},se={class:"block"},ne={class:"flex pl-0 rounded list-none flex-wrap"},re=["disabled"],le=["onClick"],ie=["disabled"],ue={class:"text-sm text-gray-600 mt-2"},Pe=U({__name:"index",async setup(ce){let _,b;K("Daftar Peminjaman");const v=T("search"),y=T("page"),k=x(""),f=x(1),{data:t,refresh:S}=([_,b]=W(()=>O("/loans",{query:{search:k,page:f},default:()=>({current_page:1,data:[],first_page_url:"",from:0,last_page:1,last_page_url:"",links:[],next_page_url:null,path:"",per_page:15,prev_page_url:null,to:0,total:0})})),_=await _,b(),_),w=x(null);async function A(){D("Peminjaman berhasil dihapus","success"),window.scrollTo({top:0,behavior:"smooth"}),await S()}async function q(){D("Gagal menghapus peminjaman","error"),window.scrollTo({top:0,behavior:"smooth"})}$(v,async()=>{k.value=v.value||"",f.value=1},{throttle:1e3}),$(y,async()=>{f.value=parseInt(y.value||"1")},{throttle:500});function B(s){return new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function V(s){return s?"Dikembalikan":"Dipinjam"}function F(s){return s?"text-green-600":"text-orange-600"}function g(s){s>=1&&s<=t.value.last_page&&X({path:"/loans",query:{...Y().query,page:s.toString()}})}function I(){t.value.prev_page_url&&g(t.value.current_page-1)}function N(){t.value.next_page_url&&g(t.value.current_page+1)}return(s,p)=>{const Q=M,u=J,R=G,z=E,L=H;return i(),c("div",ee,[o("div",te,[r(Q),o("div",ae,[r(z,{columns:["Peminjam","Petugas","Jumlah Alat","Tanggal Pinjam","Status"],path:"/loans/new"},{default:l(()=>[(i(!0),c(j,null,P(a(t).data,e=>(i(),Z(R,{key:e.id,path:`/loans/${e.id}`,btn1:"Detail",onDelete:h=>a(w).select(e.id,"Peminjaman "+e.id+" - "+e.used_by)},{default:l(()=>[r(u,{class:"font-bold"},{default:l(()=>[d(n(e.id),1)]),_:2},1024),r(u,null,{default:l(()=>[d(n(e.used_by),1)]),_:2},1024),r(u,null,{default:l(()=>[d(n(e.staff.name),1)]),_:2},1024),r(u,null,{default:l(()=>[d(n(e.tools_count)+" alat",1)]),_:2},1024),r(u,null,{default:l(()=>[d(n(B(e.loan_date)),1)]),_:2},1024),r(u,{class:m(F(e.return_date))},{default:l(()=>[d(n(V(e.return_date)),1)]),_:2},1032,["class"])]),_:2},1032,["path","onDelete"]))),128))]),_:1}),a(t).last_page>1?(i(),c("div",oe,[o("nav",se,[o("ul",ne,[o("li",null,[o("button",{onClick:I,disabled:!a(t).prev_page_url,class:m(["first:ml-0 text-xs font-semibold flex w-8 h-8 mx-1 p-0 rounded-full items-center justify-center leading-tight relative border border-solid border-pink-500",a(t).prev_page_url?"bg-white text-pink-500 hover:bg-pink-50 cursor-pointer":"bg-gray-100 text-gray-400 cursor-not-allowed"])},p[0]||(p[0]=[o("i",{class:"fas fa-chevron-left -ml-px"},null,-1)]),10,re)]),(i(!0),c(j,null,P(a(t).links,(e,h)=>(i(),c("li",{key:e.label},[h>0&&h<a(t).links.length-1?(i(),c("button",{key:0,onClick:de=>g(parseInt(e.label)),class:m(["first:ml-0 text-xs font-semibold flex w-8 h-8 mx-1 p-0 rounded-full items-center justify-center leading-tight relative border border-solid border-pink-500",e.active?"text-white bg-pink-500":"bg-white text-pink-500 hover:bg-pink-50 cursor-pointer"])},n(e.label),11,le)):C("",!0)]))),128)),o("li",null,[o("button",{onClick:N,disabled:!a(t).next_page_url,class:m(["first:ml-0 text-xs font-semibold flex w-8 h-8 mx-1 p-0 rounded-full items-center justify-center leading-tight relative border border-solid border-pink-500",a(t).next_page_url?"bg-white text-pink-500 hover:bg-pink-50 cursor-pointer":"bg-gray-100 text-gray-400 cursor-not-allowed"])},p[1]||(p[1]=[o("i",{class:"fas fa-chevron-right -mr-px"},null,-1)]),10,ie)])])]),o("div",ue," Menampilkan "+n(a(t).from)+" sampai "+n(a(t).to)+" dari "+n(a(t).total)+" data ",1)])):C("",!0)]),r(L,{store:"loan",ref_key:"modal",ref:w,onDeleted:A,onFailed:q},null,512)])])}}});export{Pe as default};
