import{N as w,r as n,O as A,L as c}from"./DILZzNnB.js";import{u as $,a as C,b as L}from"./BLw3PmVo.js";import{u as N}from"./RxiBsf8a.js";const x=w("loan",()=>{const s=n(0),e=n({used_by:"",tools:[],loan_date:"",return_date:null,staff:""}),t=n({used_by:"",tools:""});async function _(u){var o,l,d,i,v,f;if(u)s.value=u;else if(!s.value)return;const a=await $(`/loans/${s.value}`,{});if(a.data.value){e.value.used_by=(o=a.data.value)==null?void 0:o.used_by,e.value.tools=(((l=a.data.value)==null?void 0:l.tools)||[]).map(r=>({id:r.id,name:r.name,condition_before:r.pivot.condition_before,condition_after:r.pivot.condition_after||r.pivot.condition_before})),e.value.loan_date=(d=a.data.value)==null?void 0:d.loan_date,e.value.return_date=(i=a.data.value)==null?void 0:i.return_date,e.value.staff=((f=(v=a.data.value)==null?void 0:v.staff)==null?void 0:f.name)||"";return}throw A({statusCode:404,statusMessage:"Not Found"})}async function y(){return!await C(`/loans/${s.value}`)}async function b(){var a,o;const u=await L("/loans",c(e));return u?(t.value.used_by=((a=u.used_by)==null?void 0:a[0])||"",t.value.tools=((o=u.tools)==null?void 0:o[0])||"",!1):(t.value.used_by="",t.value.tools="",!0)}async function p(){var a,o;const u=await N(`/loans/${s.value}`,c(e));return u?(t.value.used_by=((a=u.used_by)==null?void 0:a[0])||"",t.value.tools=((o=u.tools)==null?void 0:o[0])||"",!1):(t.value.used_by="",t.value.tools="",!0)}function m(){s.value=0,e.value.used_by="",e.value.tools=[],e.value.loan_date="",e.value.return_date=null,t.value.used_by="",t.value.tools=""}return{id:s,data:e,error:t,load:_,create:b,update:p,delete:y,reset:m}});export{x as u};
